<style>
    canvas {
        width: 100px;
        height: 100px;
        background-color: red;
    }
</style>
<body>
    <p>This tests passes if two green rectangles are drawn.</p>
    <svg width="100" height="100">
        <image width="100%" height="100%"/>
    </svg>
    <canvas></canvas>
    <script>
        function loadImage(href) {
            return new Promise((resolve) => {
                let image = document.querySelector('image');
                image.setAttribute("href", href);
                image.decode().then(() => {
                    resolve();
                });
            });
        }

        if (window.testRunner)
            testRunner.waitUntilDone();

        loadImage("resources/green-400x400.png").then(() => {
            let canvas = document.querySelector("canvas");
            let context = canvas.getContext("2d");
            let image = document.querySelector('image');
            context.drawImage(image, 0, 0, canvas.width, canvas.height);
            if (window.testRunner)
                testRunner.notifyDone();
        });
    </script>
</body>
